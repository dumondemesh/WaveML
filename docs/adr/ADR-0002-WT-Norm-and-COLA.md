# ADR-0002: WT-нормировка и COLA-политика
## Контекст
Для устойчивого WT-roundtrip (W ∘ T_inv ≈ Id) нужна согласованная нормировка окон и шагов, а также политика краёв, совместимая с R7 (zero-pad запрещён). Требование спринта: фиксированные RMSE‑пороги и запись `W.params` и `perf` в .wfr.

## Решение
1. **Окна и COLA**: используем окна Hann/Hamming/Blackman с нормировкой, удовлетворяющей критерию COLA при `hop = n_fft/2` (Hann), `hop = n_fft/4` (Blackman) и т.п. В базовой конфигурации: Hann + hop = n_fft/2.
2. **Нормировка**: амплитудная нормировка ISTFT включает деление на сумму перекрывающихся окон:  
   \( y[t] = \frac{\sum_k x_k[t] w[t-k\,hop]}{\sum_k w^2[t-k\,hop] + \epsilon} \).
3. **Края (R7)**: только `pad_mode=reflect`, `center=true|false` — разрешены. Никакого zero-pad.
4. **Параметры**: `W.params = {n_fft, hop, window, center, pad_mode}` фиксируются в IR и протоколируются в отчётах .wfr.
5. **Метрики perf**: `perf = {rmse, snr_db, elapsed_ms}` минимум для WT-roundtrip; допускается расширение.

## Последствия
- Обеспечивается воспроизводимый WT-roundtrip при корректных парах (окно, hop).
- Добавление полей — MINOR‑bump ABI (1.1). Обратная совместимость с 1.0 сохраняется (необязательные поля).
